# Nuitka打包配置文件
# 使用方法: python -m nuitka @nuitka.config HostServer.py

# 基本选项
--standalone
--onefile
--assume-yes-for-downloads
--show-progress
--show-memory

# 性能选项（多线程编译）
--jobs=8

# 输出配置
--output-dir=build_nuitka
--output-filename=OpenIDCS-Client.exe

# Windows选项
--windows-console-mode=force
--windows-icon-from-ico=HostConfig/HostManage.ico

# 优化选项
--enable-plugin=anti-bloat

# 包含的包（核心依赖）
--include-package=flask
--include-package=loguru
--include-package=requests
--include-package=psutil
--include-package=GPUtil
--include-package=cpuinfo
--include-package=setuptools
--include-package=py7zr
--include-package=jinja2
--include-package=werkzeug
--include-package=click
--include-package=itsdangerous
--include-package=markupsafe

# Windows 特定包（仅 Windows）
# --include-package=pythonnet

# 虚拟化支持包（可选，如果已安装会自动包含）
# 如果需要这些功能，请先安装对应的包，然后取消下面的注释
# --include-package=pyvmomi
# --include-package=pylxd
# --include-package=docker

# 包含项目模块
--include-package=HostModule
--include-package=HostServer
--include-package=MainObject
--include-package=VNCConsole
--include-package=Websockify

# 排除不需要的包
--nofollow-import-to=tkinter
--nofollow-import-to=test
--nofollow-import-to=unittest
--nofollow-import-to=distutils.tests
--nofollow-import-to=setuptools.tests

# 排除外部的 websockify 包（使用本地的 Websockify 模块）
--nofollow-import-to=websockify

# 包含数据目录
--include-data-dir=WebDesigns=WebDesigns
--include-data-dir=VNCConsole/Sources=VNCConsole/Sources
--include-data-dir=HostConfig=HostConfig

# 包含数据文件
--include-data-file=HostConfig/HostManage.sql=HostConfig/HostManage.sql
